import { CaseStudyViewer } from '@/components/CaseStudyViewer'
import { getCaseStudyBySlug } from '@/lib/caseStudies'
import { Heading } from '@/components/Heading'
import { QuoteBlock } from '@/components/case-studies/QuoteBlock'
import { ProseSection, ProseBlock } from '@/components/case-studies/ProseSection'
import { LearningCard } from '@/components/case-studies/LearningCard'
import { Tooltip } from '@/components/ui/tooltip-card'
import { Highlighter } from '@/components/ui/highlighter'
import { FadeIn } from '@/components/ui/fade-in'
import { QrCode, MapPin, Calendar, Armchair, Sparkles, Zap, Clock, Code, FileCode, Palette, FileText } from 'lucide-react'
import PrototypeEmbed from '@/components/prototypes/houston-ballet/PrototypeEmbed'

export const metadata = {
  title: 'Houston Ballet - Case Study',
  description: 'A reflection on how AI tooling is changing design work, told through a mobile ticketing prototype.',
}

export const sections = [
  { title: 'Context', id: 'context' },
  { title: 'The Experiment', id: 'the-experiment' },
  { title: 'Try It', id: 'try-it' },
  { title: 'What Happened Next', id: 'what-happened-next' },
  { title: 'What This Means', id: 'what-this-means' },
]

export default function HoustonBalletCaseStudy() {
  const caseStudy = getCaseStudyBySlug('houston-ballet')
  
  if (!caseStudy) {
    return <div>Case study not found</div>
  }

  const summary = {
    context: 'Jixaw Technologies needed to explore whether AI-assisted design tooling (Figma Make) could accelerate product delivery — Houston Ballet\u0027s mobile ticketing as the proof case.',
    constraints: 'One-day build constraint to test the AI-assisted workflow; designing for APIs that don\u0027t exist yet; needed multi-tenant architecture from day one.',
    decisions: 'Designed TypeScript interfaces as API contracts before any backend existed; built multi-tenant architecture (design tokens, feature flags, service abstractions) instead of a one-off; wrote a 337-line developer handoff guide documenting open questions.',
    impact: 'Functional React prototype built in one day; 4,900+ lines of infrastructure code; 15+ TypeScript interfaces; proved the workflow for future clients.',
  }

  const metrics = [
    {
      label: 'Infrastructure Code',
      value: 4900,
      suffix: '+ lines',
      description: 'Types, services, hooks, config, tokens, themes',
      highlight: true,
    },
    {
      label: 'TypeScript Interfaces',
      value: 15,
      suffix: '+',
      description: 'Contracts for APIs that don\'t exist yet',
      highlight: true,
    },
    {
      label: 'Developer Guide',
      value: 337,
      suffix: ' lines',
      description: 'Handoff documentation with open questions documented',
      highlight: true,
    }
  ]

  return (
    <CaseStudyViewer caseStudy={caseStudy} metrics={metrics} summary={summary}>
      
      {/* Context - lighter touch */}
      <ProseSection>
        <ProseBlock>
          <Heading id="context" level={2} label="Background" className="mt-0">Context</Heading>
          <p>
            I've been working with Houston Ballet through <Tooltip containerClassName="inline" content="A technology consultancy I work with on ticketing and venue experience projects."><span className="font-bold">Jixaw Technologies</span></Tooltip> for a while now. Ticketing flows, purchase paths, the usual. They're a good client. Clear feedback, realistic timelines, no drama. If you've freelanced, you know how rare that is.
          </p>
          <p>
            This case study is a little different. There's no dramatic problem statement here. No "the system was broken and we fixed it" arc. Instead, this is a reflection on something I've been thinking about a lot lately: <strong>how AI tooling is actually changing the work.</strong>
          </p>
          <p>
            The prototype below started as a quick exploration, a way to show what a mobile ticketing experience <em>could</em> feel like. But the process of making it turned into something more interesting than the artifact itself.
          </p>
        </ProseBlock>
      </ProseSection>

      {/* The Experiment - Figma Make */}
      <ProseSection>
        <ProseBlock>
          <Heading id="the-experiment" level={2} label="Process">The Experiment</Heading>
          <p>
            Look, I'll be honest: natural language prompting has been pretty rough for a while. I've tried the "describe what you want and watch it appear" tools. Most of them produce something that looks like a website from 2008 had a fever dream. The gap between "what I imagined" and "what appeared" was usually big enough to make the whole exercise feel pointless.
          </p>
          <p>
            <Tooltip containerClassName="inline" content="A tool that converts Figma designs into production-ready code using AI, part of the emerging 'design-to-code' workflow."><span className="font-bold">Figma Make</span></Tooltip> is different. Not perfect (I'll get to that), but different enough that it changed how I approached this project.
          </p>
        </ProseBlock>

        <ProseBlock delay={0.1} className="mt-8">
          <h3>The Workflow That Actually Worked</h3>
          <p>
            Here's what I did: I started with grey boxes. Literal rectangles representing the <Tooltip containerClassName="inline" content="The structural blueprint of how screens, content, and features are organized. The skeleton before the skin."><span className="font-bold">information architecture</span></Tooltip>. Header here, list of tickets there, navigation at the bottom. No colors, no polish. Just structure.
          </p>
          <p>
            Then I layered in Houston Ballet's brand assets. Logo, color palette, typography. The tool understood these as constraints, not suggestions. When I asked for "a ticket card," it used the purple from the brand, not some default blue.
          </p>
          <p>
            From there, I could iterate in natural language. "Make the QR code bigger." "Add seat information below the date." "Put a hamburger menu in the header." Natural language iteration itself isn't new to me—I use it constantly in Cursor for code. But this felt different. I could rough something out in low fidelity, select it, and watch the tool dial up the fidelity spectrum. Grey boxes became styled components. Placeholder text became real UI. The speed comes from staying in a tool I already know while AI handles the jump from rough to refined.
          </p>
        </ProseBlock>

        <FadeIn delay={0.15}>
          <div className="grid grid-cols-1 md:grid-cols-3 gap-6 my-8">
            <div className="bg-white dark:bg-zinc-800/50 rounded-xl border border-zinc-200 dark:border-zinc-700 p-5">
              <div className="flex items-center gap-3 mb-3">
                <div className="p-2 bg-zinc-100 dark:bg-zinc-700 rounded-lg">
                  <Clock className="h-4 w-4 text-zinc-600 dark:text-zinc-300" />
                </div>
                <h4 className="text-zinc-900 dark:text-white font-semibold text-sm">Morning</h4>
              </div>
              <p className="text-sm text-zinc-600 dark:text-zinc-400">
                Grey-box wireframes. IA skeleton. Basic screen flow mapped out.
              </p>
            </div>

            <div className="bg-white dark:bg-zinc-800/50 rounded-xl border border-zinc-200 dark:border-zinc-700 p-5">
              <div className="flex items-center gap-3 mb-3">
                <div className="p-2 bg-zinc-100 dark:bg-zinc-700 rounded-lg">
                  <Sparkles className="h-4 w-4 text-zinc-600 dark:text-zinc-300" />
                </div>
                <h4 className="text-zinc-900 dark:text-white font-semibold text-sm">Afternoon</h4>
              </div>
              <p className="text-sm text-zinc-600 dark:text-zinc-400">
                Brand assets in. Natural language iteration. Real components taking shape.
              </p>
            </div>

            <div className="bg-white dark:bg-zinc-800/50 rounded-xl border border-zinc-200 dark:border-zinc-700 p-5">
              <div className="flex items-center gap-3 mb-3">
                <div className="p-2 bg-zinc-100 dark:bg-zinc-700 rounded-lg">
                  <Zap className="h-4 w-4 text-zinc-600 dark:text-zinc-300" />
                </div>
                <h4 className="text-zinc-900 dark:text-white font-semibold text-sm">Evening</h4>
              </div>
              <p className="text-sm text-zinc-600 dark:text-zinc-400">
                Functional React prototype. Exported, cleaned up, deployed.
              </p>
            </div>
          </div>
        </FadeIn>

        <ProseBlock delay={0.2}>
          <p>
            With my core loop focused in Figma Make, I had everything in one place—sketch, refine, iterate, repeat. No switching contexts, no exporting and re-importing. That tight feedback cycle let me focus on the decisions that actually matter: interaction patterns, information hierarchy, the stuff that makes a prototype <em>useful</em> instead of just pretty.
          </p>
        </ProseBlock>
      </ProseSection>

      {/* Quote */}
      <QuoteBlock className="my-16">
        The{' '}
        <Highlighter action="underline">
          best way
        </Highlighter>
        {' '}to show what something feels like is to{' '}
        <Highlighter action="highlight">
          let people use it
        </Highlighter>
        .
      </QuoteBlock>

      {/* Interactive Prototype + Design Approach - Side by Side on Desktop */}
      <section className="mb-16">
        <div className="prose prose-zinc dark:prose-invert max-w-none mb-8">
          <Heading id="try-it" level={2} label="Prototype">Try It</Heading>
          <p>
            Here's the prototype. Tap around, explore the ticket list, view QR codes, check account settings, browse venue info. It's a real React app, not a clickable mockup. That distinction matters when you're trying to communicate <em>how something feels</em>, not just how it looks.
          </p>
        </div>

        {/* Side-by-side layout on desktop */}
        <div className="grid grid-cols-1 xl:grid-cols-2 gap-8 xl:gap-12 items-start">
          {/* Prototype */}
          <div className="xl:sticky xl:top-24">
            <div className="flex justify-center">
              <PrototypeEmbed />
            </div>
            <p className="text-[10px] text-zinc-400 dark:text-zinc-500 text-center mt-3 leading-relaxed">
              Not representative of final product. All brand assets are property of Houston Ballet.
            </p>
          </div>

          {/* Design Decisions */}
          <div className="space-y-8">
            <div className="prose prose-zinc dark:prose-invert max-w-none">
              <h3 className="mt-0">Design Decisions</h3>
              <p>
                A theater lobby isn't a living room. Low light, one hand free (the other's holding a coat or a partner), and you've got about three seconds before the usher needs to see your ticket. These constraints shaped everything.
              </p>
            </div>

            {/* Design Decision Cards */}
            <div className="space-y-4">
              <div className="bg-white dark:bg-zinc-800/50 rounded-xl border border-zinc-200 dark:border-zinc-700 p-5">
                <div className="flex items-start gap-3">
                  <div className="p-2 bg-zinc-100 dark:bg-zinc-700 rounded-lg shrink-0">
                    <QrCode className="h-4 w-4 text-zinc-600 dark:text-zinc-300" />
                  </div>
                  <div>
                    <h4 className="text-zinc-900 dark:text-white font-semibold text-sm mb-1">High Contrast QR Codes</h4>
                    <p className="text-sm text-zinc-600 dark:text-zinc-400">
                      Dark purple borders on white. Scans reliably even in dim lobby lighting. (This sounds obvious until you've watched someone struggle with a low-contrast QR code at a venue entrance.)
                    </p>
                  </div>
                </div>
              </div>

              <div className="bg-white dark:bg-zinc-800/50 rounded-xl border border-zinc-200 dark:border-zinc-700 p-5">
                <div className="flex items-start gap-3">
                  <div className="p-2 bg-zinc-100 dark:bg-zinc-700 rounded-lg shrink-0">
                    <Armchair className="h-4 w-4 text-zinc-600 dark:text-zinc-300" />
                  </div>
                  <div>
                    <h4 className="text-zinc-900 dark:text-white font-semibold text-sm mb-1">Seat Info on the QR Screen</h4>
                    <p className="text-sm text-zinc-600 dark:text-zinc-400">
                      Ushers always ask "which section?" while scanning. Keeping seat info visible eliminates that back-and-forth. Small thing, but it matters when you're holding up a line.
                    </p>
                  </div>
                </div>
              </div>

              <div className="bg-white dark:bg-zinc-800/50 rounded-xl border border-zinc-200 dark:border-zinc-700 p-5">
                <div className="flex items-start gap-3">
                  <div className="p-2 bg-zinc-100 dark:bg-zinc-700 rounded-lg shrink-0">
                    <MapPin className="h-4 w-4 text-zinc-600 dark:text-zinc-300" />
                  </div>
                  <div>
                    <h4 className="text-zinc-900 dark:text-white font-semibold text-sm mb-1">Planning Gets Its Own Section</h4>
                    <p className="text-sm text-zinc-600 dark:text-zinc-400">
                      Parking, dining, venue details. Not buried in settings. For occasional theater-goers, this practical info often matters more than account preferences.
                    </p>
                  </div>
                </div>
              </div>

              <div className="bg-white dark:bg-zinc-800/50 rounded-xl border border-zinc-200 dark:border-zinc-700 p-5">
                <div className="flex items-start gap-3">
                  <div className="p-2 bg-zinc-100 dark:bg-zinc-700 rounded-lg shrink-0">
                    <Calendar className="h-4 w-4 text-zinc-600 dark:text-zinc-300" />
                  </div>
                  <div>
                    <h4 className="text-zinc-900 dark:text-white font-semibold text-sm mb-1">Date-Sorted by Default</h4>
                    <p className="text-sm text-zinc-600 dark:text-zinc-400">
                      Most people check their tickets close to showtime. Soonest first makes sense. Title sort exists for the season-ticket holders managing multiple performances.
                    </p>
                  </div>
                </div>
              </div>
            </div>

            <div className="bg-zinc-50 dark:bg-zinc-800/30 rounded-xl p-5 border border-zinc-200 dark:border-zinc-700">
              <p className="text-sm text-zinc-600 dark:text-zinc-400">
                <span className="font-semibold text-zinc-900 dark:text-white">Explore:</span> Tap the hamburger menu to see different sections. Select a performance for the QR view. Hit "View Details" for the full venue guide.
              </p>
            </div>
          </div>
        </div>

        {/* Bridge to next section */}
        <div className="prose prose-zinc dark:prose-invert max-w-none mt-12">
          <p>
            The prototype did its job. Houston Ballet could tap through it, feel the interactions, point at things and say "more like this" or "less like that." But showing what something <em>could</em> feel like is only half the work. And the exported code had rough edges—inconsistent naming, over-nested components, hardcoded values everywhere.
          </p>
        </div>
      </section>

      {/* What Happened Next */}
      <ProseSection>
        <ProseBlock>
          <Heading id="what-happened-next" level={2} label="Refinement">What Happened Next</Heading>
          <p>
            The Figma Make export was a starting point, not a finish line. I created a GitHub repo, pulled it into Cursor, and spent another day turning it into something developers could actually build on. Taking it from "thing that works" to "thing that's ready" meant confronting a different set of problems. Not <em>can we make this?</em> but <em>can this scale? Can someone else work on it? What happens when we don't know the answer yet?</em>
          </p>
        </ProseBlock>

        <ProseBlock delay={0.1} className="mt-8">
          <h3>The Gap Between Working and Ready</h3>
          <p>
            The export ran. You could tap through it, see the QR codes, browse the venue info. But under the hood:
          </p>
          <ul>
            <li>The logo was a 40-character hash string</li>
            <li>Mock data lived directly in the main component</li>
            <li>Colors were hardcoded hex values scattered across files</li>
            <li>There was no concept of "this is Houston Ballet's app" vs "this could be anyone's app"</li>
          </ul>
          <p>
            None of that matters for a demo. All of it matters when you're handing code to developers who need to build on it. My job was to wire up the UI side—define the data contracts, set up the component boundaries, make it modular. Their job would be connecting the pipes: middleware, auth, the actual <Tooltip containerClassName="inline" content="A ticketing and CRM platform used by performing arts organizations worldwide."><span className="font-bold">Tessitura</span></Tooltip> integration.
          </p>
        </ProseBlock>

        <ProseBlock delay={0.15} className="mt-8">
          <h3>Designing for Questions You Can't Answer Yet</h3>
          <p>
            I understand <Tooltip containerClassName="inline" content="A ticketing and CRM platform used by performing arts organizations worldwide."><span className="font-bold">Tessitura's</span></Tooltip> data model from previous work—I know what a constituent record looks like, how orders are structured, what fields we'd need for ticket display. But there were still open questions:
          </p>
          <ul>
            <li>How does the proprietary QR code system work? (Gary—another dev on the team—is building it, not me)</li>
            <li>What will the middleware actually return? (It doesn't exist yet)</li>
            <li>Will clients want redirect auth or embedded SSO? (Depends on the client)</li>
            <li>What content blocks will different venues want? (Nobody's asked them yet)</li>
          </ul>
          <p>
            The temptation is to wait until you have answers. But waiting means the developers have nothing to work with. So instead, you design <em>interfaces</em> that define the contract without defining the implementation. I set things up with Tessitura in mind—the data shapes, the likely fields—so when the middleware team comes in, they can easily map their work to what the UI expects.
          </p>
        </ProseBlock>

        {/* Code Snippet - Interface Design */}
        <FadeIn delay={0.2}>
          <div className="my-8 bg-zinc-900 dark:bg-zinc-800/50 rounded-xl border border-zinc-700 overflow-hidden">
            <div className="flex items-center gap-2 px-4 py-2 bg-zinc-800 dark:bg-zinc-700/50 border-b border-zinc-700">
              <Code className="h-4 w-4 text-zinc-400" />
              <span className="text-xs text-zinc-400 font-mono">QRCodeDisplayProps.ts</span>
            </div>
            <pre className="p-4 text-sm overflow-x-auto">
              <code className="text-zinc-300 font-mono">
{`// I don't know how Gary's QR code works.
// But I know what it needs to accept.
export interface QRCodeDisplayProps {
  data: string;      // The ticket data to encode
  size?: number;     // Display size (default 200)
  className?: string;
}`}
              </code>
            </pre>
            <div className="px-4 py-3 bg-zinc-800/50 border-t border-zinc-700">
              <p className="text-xs text-zinc-400">
                Gary can implement whatever he wants behind that interface. The rest of the app doesn't care.
              </p>
            </div>
          </div>
        </FadeIn>

        <ProseBlock delay={0.25} className="mt-8">
          <h3>Multi-Tenancy from Day One</h3>
          <p>
            Gary's QR code interface was one piece. The bigger architectural decision was treating Houston Ballet as client #1—not the only client. The architecture assumes client #2 exists.
          </p>
        </ProseBlock>

        {/* Architecture Cards */}
        <FadeIn delay={0.3}>
          <div className="grid grid-cols-1 md:grid-cols-2 gap-4 my-8">
            <div className="bg-white dark:bg-zinc-800/50 rounded-xl border border-zinc-200 dark:border-zinc-700 p-5">
              <div className="flex items-start gap-3">
                <div className="p-2 bg-zinc-100 dark:bg-zinc-700 rounded-lg shrink-0">
                  <FileCode className="h-4 w-4 text-zinc-600 dark:text-zinc-300" />
                </div>
                <div>
                  <h4 className="text-zinc-900 dark:text-white font-semibold text-sm mb-1">Isolated Brand Assets</h4>
                  <p className="text-sm text-zinc-600 dark:text-zinc-400">
                    Each tenant gets their own folder. Houston Ballet's logo isn't scattered—it lives in one place.
                  </p>
                </div>
              </div>
            </div>

            <div className="bg-white dark:bg-zinc-800/50 rounded-xl border border-zinc-200 dark:border-zinc-700 p-5">
              <div className="flex items-start gap-3">
                <div className="p-2 bg-zinc-100 dark:bg-zinc-700 rounded-lg shrink-0">
                  <Palette className="h-4 w-4 text-zinc-600 dark:text-zinc-300" />
                </div>
                <div>
                  <h4 className="text-zinc-900 dark:text-white font-semibold text-sm mb-1">Theme Overrides</h4>
                  <p className="text-sm text-zinc-600 dark:text-zinc-400">
                    Colors, fonts, spacing—all parameterized. Change one CSS file and the whole app rebrands.
                  </p>
                </div>
              </div>
            </div>

            <div className="bg-white dark:bg-zinc-800/50 rounded-xl border border-zinc-200 dark:border-zinc-700 p-5">
              <div className="flex items-start gap-3">
                <div className="p-2 bg-zinc-100 dark:bg-zinc-700 rounded-lg shrink-0">
                  <Code className="h-4 w-4 text-zinc-600 dark:text-zinc-300" />
                </div>
                <div>
                  <h4 className="text-zinc-900 dark:text-white font-semibold text-sm mb-1">Feature Flags</h4>
                  <p className="text-sm text-zinc-600 dark:text-zinc-400">
                    Not every venue needs ticket transfers or venue guides. Config controls what shows up.
                  </p>
                </div>
              </div>
            </div>

            <div className="bg-white dark:bg-zinc-800/50 rounded-xl border border-zinc-200 dark:border-zinc-700 p-5">
              <div className="flex items-start gap-3">
                <div className="p-2 bg-zinc-100 dark:bg-zinc-700 rounded-lg shrink-0">
                  <FileText className="h-4 w-4 text-zinc-600 dark:text-zinc-300" />
                </div>
                <div>
                  <h4 className="text-zinc-900 dark:text-white font-semibold text-sm mb-1">Developer Handoff</h4>
                  <p className="text-sm text-zinc-600 dark:text-zinc-400">
                    337-line guide for the dev team with open questions documented, not assumed.
                  </p>
                </div>
              </div>
            </div>
          </div>
        </FadeIn>

        <ProseBlock delay={0.35}>
          <p>
            This might seem like overkill for a single client. But the cost of building it now is low. The cost of retrofitting it later—when you have production code, real users, and tight deadlines—is high.
          </p>
          <p>
            When client #2 shows up, the path is clear: add a folder, add a theme file, set an environment variable.
          </p>
        </ProseBlock>

      </ProseSection>

      {/* What This Means */}
      <ProseSection>
        <ProseBlock>
          <Heading id="what-this-means" level={2} label="Takeaways">What This Means</Heading>
          <p>
            I've been thinking about this a lot. AI isn't replacing designers—at least not yet. What it's doing is shifting where we spend our time.
          </p>
          <p>
            Before tools like this, a significant chunk of my energy went into production: translating decisions into pixels, wiring up interactions. That work still matters, but the tools are getting better at handling it. What they can't do is make the decisions—or, as it turns out, the architecture decisions that make prototypes actually usable.
          </p>
          <p>
            The prototype took a day. The architecture took another. That second day—the multi-tenant setup, the TypeScript interfaces for APIs that don't exist yet, the documentation written for the developers who'd inherit this—that's what makes the prototype matter. The tools didn't just make the first day faster. They made room for the second day to exist.
          </p>
        </ProseBlock>

        <div className="grid grid-cols-1 md:grid-cols-3 gap-6 my-8">
          <LearningCard 
            title="The value is shifting"
            icon="ArrowRight"
            index={0}
          >
            Production time compresses. Decision time stays the same (or expands). The designers who thrive will be the ones who are good at decisions, not just execution.
          </LearningCard>

          <LearningCard 
            title="I'm cautiously optimistic"
            icon="Eye"
            index={1}
          >
            The hype cycle is real. Not every AI tool is worth the breathless LinkedIn posts. But this one actually changed how I worked. That's worth paying attention to.
          </LearningCard>

          <LearningCard 
            title="Compound decisions"
            icon="Layers"
            index={2}
          >
            Multi-tenancy, design tokens, service abstractions—these feel like overkill for one client. But each decision makes the next client easier. Architecture is about making future work cheaper.
          </LearningCard>
        </div>

        <ProseBlock delay={0.1}>
          <p>
            I don't know where this goes. Maybe these tools plateau. Maybe they get dramatically better. Either way, I'd rather be experimenting with them now than catching up later. This was one experiment. There will be more.
          </p>
        </ProseBlock>
      </ProseSection>

      {/* Credits */}
      <FadeIn>
        <section className="mt-16 pt-8 border-t border-zinc-200 dark:border-zinc-700">
          <div className="prose prose-zinc dark:prose-invert max-w-none">
            <h3>Credits</h3>
            <p>Houston Ballet, Jixaw Technologies, Gary &amp; Sunny on the dev team, and everyone working to make the patron experience seamless from purchase to performance.</p>
          </div>
        </section>
      </FadeIn>
    </CaseStudyViewer>
  )
}
